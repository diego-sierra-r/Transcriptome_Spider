"0","## Anotacion"
"0",""
"0","bind_DE <- function(by) {"
"0","  if (by == ""wide"") {"
"0","    x <- list()"
"0","    for (i in DESeq2_diet_wide) {"
"0","      x[[length(x)+1]] <- as.data.frame(i[1])"
"0","      }"
"0","      DE <- list()"
"0","      for (j in x) {"
"0","        DE[[length(DE)+1]]<- as.data.frame(j)"
"0","      }"
"0","      DE <-bind_rows(DE)"
"0","      DE <- DE %>% bind_rows(as.data.frame(DESeq2_sex[1]))"
"0","    return(DE)"
"0","    }else if (by == ""granulate"") {"
"0","      x <- list()"
"0","      for (i in DESeq2_diet_granulate) {"
"0","        x[[length(x)+1]] <- i[1]"
"0","      }"
"0","      DE <- list()"
"0","      for (j in x) {"
"0","        DE[[length(DE)+1]]<- as.data.frame(j)"
"0","      }"
"0","      DE <-bind_rows(DE)"
"0","      DE <- DE %>% bind_rows(as.data.frame(DESeq2_sex[1]))"
"0","    return(DE)"
"0","    }"
"0","}"
"0",""
"0","  "
"0","DE_diet_binded <- bind_DE(by = ""granulate"")"
"0",""
"0","Annot <-read.csv(paste0(dataPath,""/ev_filtered_without_dup_for_cat.csv""))"
"0","DE_filtered <- filter(DE_diet_binded, differex != ""Not significant"")"
"0","DE_merged <- merge(x = DE_filtered, y = Annot, by = ""Contig_Name"", all.x= T )"
"0","#DE_merged <- DE_merged[!duplicated(DE_merged$Contig_Name),]"
"0","DE_annoted_and_DE <- filter(DE_merged, grepl(""^K"", Kegg_code) | evalue <= 2.20e-15)"
"0","DE_annoted_and_venomrelated <- filter(DE_annoted_and_DE, venom_related == ""YES"")"
"0",""
"0",""
"0","DE_merged_diets <- merge(x = DE_filtered, y = Annot, by = ""Contig_Name"", all.x= T ) %>% filter(.,Comparation != ""SEX Male vs Female"")"
"0","openxlsx::write.xlsx(DE_merged_diets,""~/Documentos/R/R_Transcriptome/Transcriptome_Spider/Results_DE/DE_trancripts_counts(624).xlsx"")"
"0","#DE_merged_diets <- DE_merged_diets[!duplicated(DE_merged_diets$Contig_Name),]"
"0",""
"0","DE_annoted_diets <-  filter(DE_merged_diets, grepl(""^K"", Kegg_code) | evalue <= 2.20e-15) %>% filter(., differex != ""Not significant"")"
"0",""
"0","DE_annoted_and_DE_diets <- DE_annoted_diets %>% filter(.,venom_related == ""YES"")"
"0","raw_counts_DE_annoted_and_venom_related_diets <- CountData[rownames(CountData) %in% DE_merged_diets$Contig_Name,] # ahora estos rawcount contiene todos los trancrticos venom"
"0",""
"0","openxlsx::write.xlsx(raw_counts_DE_annoted_and_venom_related_diets, ""~/Documentos/R/R_Transcriptome/Transcriptome_Spider/Results_DE/ raw_counts_DE_annoted_and_venom_related_diets.xlsx"",rowNames = T)"
"0",""
"0","raw_counts_DE_annoted_diets <-  CountData[rownames(CountData) %in% DE_annoted_diets$Contig_Name,]"
"0",""
"0","openxlsx::write.xlsx(raw_counts_DE_annoted_diets, ""~/Documentos/R/R_Transcriptome/Transcriptome_Spider/Results_DE/ raw_counts_DE_annoted_diets.xlsx"",rowNames = T)"
"0",""
